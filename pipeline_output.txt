/Users/diegogo/Documents/EngenhariaDados/StockNivida/.venv/lib/python3.11/site-packages/pyspark/bin/load-spark-env.sh: line 68: /bin/ps: Operation not permitted
26/02/02 09:16:37 WARN Utils: Your hostname, Satoro.local resolves to a loopback address: 127.0.0.1; using 192.168.0.90 instead (on interface en0)
26/02/02 09:16:37 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
26/02/02 09:16:37 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
26/02/02 09:16:41 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:42 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
26/02/02 09:16:43 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.

======================================================================
NVIDIA STOCK ANALYSIS PIPELINE
======================================================================

Pipeline Steps:
1. Initialize Spark Session
2. Load Data
3. Process Data
4. Engineer Features
5. Run Analysis
6. Create Visualizations
7. Save Results
======================================================================

======================================================================
 Initializing Spark Session
======================================================================
Spark Session created: NVIDIA Stock Analysis
Version: 3.5.0
Master: local[*]
======================================================================

======================================================================
STEP 1: DATA LOADING
======================================================================
Downloading dataset: ibrahimshahrukh/nvidia-daily-stock-prices-20162026-dataset
Dataset downloaded to: /Users/diegogo/.cache/kagglehub/datasets/ibrahimshahrukh/nvidia-daily-stock-prices-20162026-dataset/versions/1
ðŸ“‚ Loading data from: /Users/diegogo/.cache/kagglehub/datasets/ibrahimshahrukh/nvidia-daily-stock-prices-20162026-dataset/versions/1/NVDA_yfinance_clean.csv
 Data loaded successfully!
   Total records: 2,514
   Columns: 6

 Validating data quality...
 Validation complete!

 Data Summary:
======================================================================

Schema:
root
 |-- Date: string (nullable = true)
 |-- Close: double (nullable = true)
 |-- High: double (nullable = true)
 |-- Low: double (nullable = true)
 |-- Open: double (nullable = true)
 |-- Volume: double (nullable = true)


First 5 rows:
+----------+------------------+------------------+------------------+------------------+---------+
|Date      |Close             |High              |Low               |Open              |Volume   |
+----------+------------------+------------------+------------------+------------------+---------+
|2016-01-04|0.7895877957344055|0.7947102150980515|0.7815382463592808|0.787636414497714 |3.58076E8|
|2016-01-05|0.8022719025611877|0.8156878368079781|0.7927587887219967|0.8044672499447945|4.90272E8|
|2016-01-06|0.7690979838371277|0.7927587552282137|0.7600726865824283|0.7890998430767903|4.49344E8|
|2016-01-07|0.7386074066162109|0.7549504150501084|0.7288503250272015|0.7498279370385001|6.45304E8|
|2016-01-08|0.7227520942687988|0.7488521217949108|0.7212885293660111|0.7481203393435168|3.98472E8|
+----------+------------------+------------------+------------------+------------------+---------+
only showing top 5 rows


Descriptive Statistics:
+-------+----------+------------------+------------------+------------------+------------------+--------------------+
|summary|      Date|             Close|              High|               Low|              Open|              Volume|
+-------+----------+------------------+------------------+------------------+------------------+--------------------+
|  count|      2514|              2514|              2514|              2514|              2514|                2514|
|   mean|      NULL| 36.04616151495215| 36.65522831048633| 35.37176384442516| 36.05066598463091|4.5885494156722355E8|
| stddev|      NULL| 51.19606637456241|51.999095314270704| 50.31836516071126| 51.23852161067242|2.5744719111587727E8|
|    min|2016-01-04|0.6151808500289917|0.6234742624491796|0.6037163721570048| 0.604448035770586|           6.55285E7|
|    max|2025-12-31|207.02847290039062| 212.1781954922272| 205.5485506791992|208.06841462190084|          3.692928E9|
+-------+----------+------------------+------------------+------------------+------------------+--------------------+

======================================================================

======================================================================
STEP 2: DATA PROCESSING
======================================================================

======================================================================
 Starting Data Processing Pipeline
======================================================================

 Cleaning data...
   Removed 0 rows (0.00%)
   Final dataset: 2,514 rows

 Converting date column 'Date'...
    Date conversion complete

 Adding temporal features...
    Temporal features added:
      - Year, Month, Day
      - DayOfWeek, WeekDay
      - MonthName, Quarter

 Adding price features...
    Price features added:
      - Daily_Range, Daily_Return, Price_Change
      - High_Low_Ratio, Close_Open_Ratio
      - Previous_Close, Daily_Return_Close

 Adding volume features...
    Volume features added:
      - Previous_Volume, Volume_Change

======================================================================
 Data Processing Pipeline Complete!
======================================================================

Date Range: 2016-01-04 to 2025-12-31

======================================================================
STEP 3: FEATURE ENGINEERING
======================================================================

======================================================================
 Starting Feature Engineering Pipeline
======================================================================

 Calculating Moving Averages...
    SMA_7 calculated
    SMA_14 calculated
    SMA_30 calculated
    SMA_50 calculated
    SMA_200 calculated

 Calculating Bollinger Bands...
    Bollinger Bands calculated (window=20, std=2)

 Calculating RSI...
    RSI calculated (window=14)

 Calculating MACD...

 Calculating Exponential Moving Averages...
    EMA_12 calculated
    EMA_26 calculated
    MACD calculated (fast=12, slow=26, signal=9)

 Calculating Volatility Metrics...
    Volatility_7d and ATR_7d calculated
    Volatility_14d and ATR_14d calculated
    Volatility_30d and ATR_30d calculated
    Volatility_60d and ATR_60d calculated

 Calculating Momentum Indicators...
    Momentum indicators calculated

 Calculating Support/Resistance Levels...
    Support/Resistance levels calculated (window=20)

======================================================================
 Feature Engineering Complete!
   Total columns: 52
======================================================================

Final Dataset Shape:
   Rows: 2,514
   Columns: 52

======================================================================
STEP 4: COMPREHENSIVE ANALYSIS
======================================================================

======================================================================
 Starting Comprehensive Analysis
======================================================================

 Calculating Overall Statistics...

 Overall Statistics:
   Period: 2016-01-04 to 2025-12-31
   Total Records: 2,514
   Price Range: $0.62 - $207.03
   Average Price: $36.05
   Average Volume: 458,854,942

 Analyzing by Year...

Error in pipeline: [UNSUPPORTED_EXPR_FOR_WINDOW] Expression "Avg_Close" not supported within a window function.;
Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361, Yearly_Return#5389]
+- Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361, _we0#5390, _we1#5391, (((Avg_Close#5348 - _we0#5390) / _we1#5391) * cast(100 as double)) AS Yearly_Return#5389]
   +- Window [Avg_Close#5348 windowspecdefinition(Year#502 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we0#5390, Avg_Close#5348 windowspecdefinition(Year#502 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we1#5391], [Year#502 ASC NULLS FIRST]
      +- Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361]
         +- Sort [Year#502 ASC NULLS FIRST], true
            +- Aggregate [Year#502], [Year#502, count(1) AS Trading_Days#5346L, avg(Close#1) AS Avg_Close#5348, min(Close#1) AS Min_Close#5350, max(Close#1) AS Max_Close#5352, stddev(Close#1) AS Volatility#5353, sum(Volume#5) AS Total_Volume#5355, avg(Daily_Return_Close#684) AS Avg_Daily_Return#5357, min(Daily_Return_Close#684) AS Min_Daily_Return#5359, max(Daily_Return_Close#684) AS Max_Daily_Return#5361]
               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 28 more fields]
                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 29 more fields]
                     +- Window [min(Low#3) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS Support_20d#2214], [Date#495 ASC NULLS FIRST]
                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 27 more fields]
                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 27 more fields]
                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 28 more fields]
                                 +- Window [max(High#2) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS Resistance_20d#2161], [Date#495 ASC NULLS FIRST]
                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 25 more fields]
                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 24 more fields]
                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                                   +- Window [lag(Close#1, -10, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -10, -10)) AS _we0#2009, lag(Close#1, -10, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -10, -10)) AS _we1#2010], [Date#495 ASC NULLS FIRST]
                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 24 more fields]
                                                               +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -59, currentrow$())) AS ATR_60d#1960], [Date#495 ASC NULLS FIRST]
                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                                           +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -59, currentrow$())) AS Volatility_60d#1903], [Date#495 ASC NULLS FIRST]
                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                                       +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS ATR_30d#1857], [Date#495 ASC NULLS FIRST]
                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                                   +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS Volatility_30d#1802], [Date#495 ASC NULLS FIRST]
                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                                               +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS ATR_14d#1758], [Date#495 ASC NULLS FIRST]
                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                                           +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Volatility_14d#1705], [Date#495 ASC NULLS FIRST]
                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                                       +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS ATR_7d#1663], [Date#495 ASC NULLS FIRST]
                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                                   +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS Volatility_7d#1612], [Date#495 ASC NULLS FIRST]
                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                  +- Window [avg(MACD#1494) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -8, currentrow$())) AS MACD_Signal#1533], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                 +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -25, currentrow$())) AS EMA_26#1457], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                             +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -11, currentrow$())) AS EMA_12#1420], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                                                                  +- Window [avg(Loss#1188) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Avg_Loss#1265], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                                                                                              +- Window [avg(Gain#1152) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Avg_Gain#1226], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                                                                                +- Window [lag(Close#1, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we0#1117], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 9 more fields]
                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 9 more fields]
                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 8 more fields]
                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 7 more fields]
                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 6 more fields]
                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 5 more fields]
                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 6 more fields]
                                                                                                                                                                                                                                                                        +- Window [stddev(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS BB_Std#947], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 5 more fields]
                                                                                                                                                                                                                                                                                    +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS BB_Middle#918], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                                                +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -199, currentrow$())) AS SMA_200#889], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                                            +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -49, currentrow$())) AS SMA_50#861], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_30#834]
                                                                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_30#834]
                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                                        +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS SMA_30#834], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808]
                                                                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808]
                                                                                                                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_14#808]
                                                                                                                                                                                                                                                                                                                                    +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS SMA_14#808], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                                +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS SMA_7#783], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727]
                                                                                                                                                                                                                                                                                                                                                      +- Sort [Date#495 ASC NULLS FIRST], true
                                                                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, CASE WHEN isnotnull(Previous_Volume#705) THEN (((Volume#5 - Previous_Volume#705) / Previous_Volume#705) * cast(100 as double)) ELSE cast(null as double) END AS Volume_Change#727]
                                                                                                                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705]
                                                                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Previous_Volume#705]
                                                                                                                                                                                                                                                                                                                                                                  +- Window [lag(Volume#5, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS Previous_Volume#705], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684]
                                                                                                                                                                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, CASE WHEN isnotnull(Previous_Close#664) THEN (((Close#1 - Previous_Close#664) / Previous_Close#664) * cast(100 as double)) ELSE cast(null as double) END AS Daily_Return_Close#684]
                                                                                                                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664]
                                                                                                                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Previous_Close#664]
                                                                                                                                                                                                                                                                                                                                                                                 +- Window [lag(Close#1, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS Previous_Close#664], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645]
                                                                                                                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, (Close#1 / Open#4) AS Close_Open_Ratio#645]
                                                                                                                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, (High#2 / Low#3) AS High_Low_Ratio#627]
                                                                                                                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, (Close#1 - Open#4) AS Price_Change#610]
                                                                                                                                                                                                                                                                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, (((Close#1 - Open#4) / Open#4) * cast(100 as double)) AS Daily_Return#594]
                                                                                                                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, (High#2 - Low#3) AS Daily_Range#579]
                                                                                                                                                                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, CASE WHEN Month#510 IN (1,2,3) THEN 1 WHEN Month#510 IN (4,5,6) THEN 2 WHEN Month#510 IN (7,8,9) THEN 3 ELSE 4 END AS Quarter#565]
                                                                                                                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, date_format(cast(Date#495 as timestamp), MMMM, Some(Europe/Rome)) AS MonthName#552]
                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, date_format(cast(Date#495 as timestamp), EEEE, Some(Europe/Rome)) AS WeekDay#540]
                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, dayofweek(Date#495) AS DayOfWeek#529]
                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, dayofmonth(Date#495) AS Day#519]
                                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, month(Date#495) AS Month#510]
                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, year(Date#495) AS Year#502]
                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [to_date(Date#0, Some(yyyy-MM-dd), Some(Europe/Rome), false) AS Date#495, Close#1, High#2, Low#3, Open#4, Volume#5]
                                                                                                                                                                                                                                                                                                                                                                                                                              +- Deduplicate [Date#0]
                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Filter atleastnnonnulls(6, Date#0, Open#4, High#2, Low#3, Close#1, Volume#5)
                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation [Date#0,Close#1,High#2,Low#3,Open#4,Volume#5] csv
Traceback (most recent call last):
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/main.py", line 183, in main
    analysis_results = analyzer.run_comprehensive_analysis(df_features)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/src/analyzer.py", line 353, in run_comprehensive_analysis
    'yearly_analysis': self.analyze_by_year(df),
                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/src/analyzer.py", line 100, in analyze_by_year
    yearly_analysis = yearly_analysis.withColumn(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/.venv/lib/python3.11/site-packages/pyspark/sql/dataframe.py", line 5170, in withColumn
    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sparkSession)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/.venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/diegogo/Documents/EngenhariaDados/StockNivida/.venv/lib/python3.11/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [UNSUPPORTED_EXPR_FOR_WINDOW] Expression "Avg_Close" not supported within a window function.;
Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361, Yearly_Return#5389]
+- Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361, _we0#5390, _we1#5391, (((Avg_Close#5348 - _we0#5390) / _we1#5391) * cast(100 as double)) AS Yearly_Return#5389]
   +- Window [Avg_Close#5348 windowspecdefinition(Year#502 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we0#5390, Avg_Close#5348 windowspecdefinition(Year#502 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we1#5391], [Year#502 ASC NULLS FIRST]
      +- Project [Year#502, Trading_Days#5346L, Avg_Close#5348, Min_Close#5350, Max_Close#5352, Volatility#5353, Total_Volume#5355, Avg_Daily_Return#5357, Min_Daily_Return#5359, Max_Daily_Return#5361]
         +- Sort [Year#502 ASC NULLS FIRST], true
            +- Aggregate [Year#502], [Year#502, count(1) AS Trading_Days#5346L, avg(Close#1) AS Avg_Close#5348, min(Close#1) AS Min_Close#5350, max(Close#1) AS Max_Close#5352, stddev(Close#1) AS Volatility#5353, sum(Volume#5) AS Total_Volume#5355, avg(Daily_Return_Close#684) AS Avg_Daily_Return#5357, min(Daily_Return_Close#684) AS Min_Daily_Return#5359, max(Daily_Return_Close#684) AS Max_Daily_Return#5361]
               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 28 more fields]
                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 29 more fields]
                     +- Window [min(Low#3) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS Support_20d#2214], [Date#495 ASC NULLS FIRST]
                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 27 more fields]
                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 27 more fields]
                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 28 more fields]
                                 +- Window [max(High#2) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS Resistance_20d#2161], [Date#495 ASC NULLS FIRST]
                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 25 more fields]
                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 24 more fields]
                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 26 more fields]
                                                   +- Window [lag(Close#1, -10, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -10, -10)) AS _we0#2009, lag(Close#1, -10, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -10, -10)) AS _we1#2010], [Date#495 ASC NULLS FIRST]
                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 24 more fields]
                                                               +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -59, currentrow$())) AS ATR_60d#1960], [Date#495 ASC NULLS FIRST]
                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 23 more fields]
                                                                           +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -59, currentrow$())) AS Volatility_60d#1903], [Date#495 ASC NULLS FIRST]
                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 22 more fields]
                                                                                       +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS ATR_30d#1857], [Date#495 ASC NULLS FIRST]
                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 21 more fields]
                                                                                                   +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS Volatility_30d#1802], [Date#495 ASC NULLS FIRST]
                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 20 more fields]
                                                                                                               +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS ATR_14d#1758], [Date#495 ASC NULLS FIRST]
                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 19 more fields]
                                                                                                                           +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Volatility_14d#1705], [Date#495 ASC NULLS FIRST]
                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 18 more fields]
                                                                                                                                       +- Window [avg(Daily_Range#579) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS ATR_7d#1663], [Date#495 ASC NULLS FIRST]
                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 17 more fields]
                                                                                                                                                   +- Window [stddev(Daily_Return_Close#684) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS Volatility_7d#1612], [Date#495 ASC NULLS FIRST]
                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                  +- Window [avg(MACD#1494) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -8, currentrow$())) AS MACD_Signal#1533], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                 +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -25, currentrow$())) AS EMA_26#1457], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                             +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -11, currentrow$())) AS EMA_12#1420], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 16 more fields]
                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 15 more fields]
                                                                                                                                                                                                                  +- Window [avg(Loss#1188) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Avg_Loss#1265], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 13 more fields]
                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 14 more fields]
                                                                                                                                                                                                                              +- Window [avg(Gain#1152) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS Avg_Gain#1226], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 12 more fields]
                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 10 more fields]
                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 11 more fields]
                                                                                                                                                                                                                                                +- Window [lag(Close#1, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS _we0#1117], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 9 more fields]
                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 9 more fields]
                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 8 more fields]
                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 7 more fields]
                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 6 more fields]
                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 5 more fields]
                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 6 more fields]
                                                                                                                                                                                                                                                                        +- Window [stddev(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS BB_Std#947], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 5 more fields]
                                                                                                                                                                                                                                                                                    +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -19, currentrow$())) AS BB_Middle#918], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 4 more fields]
                                                                                                                                                                                                                                                                                                +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -199, currentrow$())) AS SMA_200#889], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 3 more fields]
                                                                                                                                                                                                                                                                                                            +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -49, currentrow$())) AS SMA_50#861], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_30#834]
                                                                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_30#834]
                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, ... 2 more fields]
                                                                                                                                                                                                                                                                                                                        +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -29, currentrow$())) AS SMA_30#834], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808]
                                                                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808]
                                                                                                                                                                                                                                                                                                                                 +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_14#808, SMA_14#808]
                                                                                                                                                                                                                                                                                                                                    +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -13, currentrow$())) AS SMA_14#808], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727, SMA_7#783, SMA_7#783]
                                                                                                                                                                                                                                                                                                                                                +- Window [avg(Close#1) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -6, currentrow$())) AS SMA_7#783], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Volume_Change#727]
                                                                                                                                                                                                                                                                                                                                                      +- Sort [Date#495 ASC NULLS FIRST], true
                                                                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, CASE WHEN isnotnull(Previous_Volume#705) THEN (((Volume#5 - Previous_Volume#705) / Previous_Volume#705) * cast(100 as double)) ELSE cast(null as double) END AS Volume_Change#727]
                                                                                                                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705]
                                                                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684, Previous_Volume#705, Previous_Volume#705]
                                                                                                                                                                                                                                                                                                                                                                  +- Window [lag(Volume#5, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS Previous_Volume#705], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Daily_Return_Close#684]
                                                                                                                                                                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, CASE WHEN isnotnull(Previous_Close#664) THEN (((Close#1 - Previous_Close#664) / Previous_Close#664) * cast(100 as double)) ELSE cast(null as double) END AS Daily_Return_Close#684]
                                                                                                                                                                                                                                                                                                                                                                           +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664]
                                                                                                                                                                                                                                                                                                                                                                              +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645, Previous_Close#664, Previous_Close#664]
                                                                                                                                                                                                                                                                                                                                                                                 +- Window [lag(Close#1, -1, null) windowspecdefinition(Date#495 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS Previous_Close#664], [Date#495 ASC NULLS FIRST]
                                                                                                                                                                                                                                                                                                                                                                                    +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, Close_Open_Ratio#645]
                                                                                                                                                                                                                                                                                                                                                                                       +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, High_Low_Ratio#627, (Close#1 / Open#4) AS Close_Open_Ratio#645]
                                                                                                                                                                                                                                                                                                                                                                                          +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, Price_Change#610, (High#2 / Low#3) AS High_Low_Ratio#627]
                                                                                                                                                                                                                                                                                                                                                                                             +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, Daily_Return#594, (Close#1 - Open#4) AS Price_Change#610]
                                                                                                                                                                                                                                                                                                                                                                                                +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, Daily_Range#579, (((Close#1 - Open#4) / Open#4) * cast(100 as double)) AS Daily_Return#594]
                                                                                                                                                                                                                                                                                                                                                                                                   +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, Quarter#565, (High#2 - Low#3) AS Daily_Range#579]
                                                                                                                                                                                                                                                                                                                                                                                                      +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, MonthName#552, CASE WHEN Month#510 IN (1,2,3) THEN 1 WHEN Month#510 IN (4,5,6) THEN 2 WHEN Month#510 IN (7,8,9) THEN 3 ELSE 4 END AS Quarter#565]
                                                                                                                                                                                                                                                                                                                                                                                                         +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, WeekDay#540, date_format(cast(Date#495 as timestamp), MMMM, Some(Europe/Rome)) AS MonthName#552]
                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, DayOfWeek#529, date_format(cast(Date#495 as timestamp), EEEE, Some(Europe/Rome)) AS WeekDay#540]
                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, Day#519, dayofweek(Date#495) AS DayOfWeek#529]
                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, Month#510, dayofmonth(Date#495) AS Day#519]
                                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, Year#502, month(Date#495) AS Month#510]
                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [Date#495, Close#1, High#2, Low#3, Open#4, Volume#5, year(Date#495) AS Year#502]
                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [to_date(Date#0, Some(yyyy-MM-dd), Some(Europe/Rome), false) AS Date#495, Close#1, High#2, Low#3, Open#4, Volume#5]
                                                                                                                                                                                                                                                                                                                                                                                                                              +- Deduplicate [Date#0]
                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Filter atleastnnonnulls(6, Date#0, Open#4, High#2, Low#3, Close#1, Volume#5)
                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation [Date#0,Close#1,High#2,Low#3,Open#4,Volume#5] csv


